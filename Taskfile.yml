version: '3'

vars:
  COMPONENT:
    sh: cat go.mod |head -1|cut -d \  -f2|cut -d / -f 3

tasks:
  lint:
    cmds:
      - golangci-lint run -v --fix
  build:
    cmds:
      - go build
  build-image:
    cmds:
      - docker build -t github.com/numary/{{.COMPONENT}} .
  run-image:
    deps:
      - build-image
    cmds:
      - docker run --rm github.com/numary/{{.COMPONENT}}